{
    "openapi": "3.1.0",
    "info": {
        "title": "Violeta API",
        "description": "Documentación de endpoints del backend Violeta\n\n**Autenticación - Dos métodos disponibles:**\n\n**1. Cookie/Session (Para aplicaciones web):**\n- Ejecuta POST /api/v1/auth/login con tus credenciales\n- La sesión se crea automáticamente (cookie JSESSIONID)\n- Los siguientes requests usan la sesión automáticamente\n- No necesitas configurar nada en \"Authorize\"\n\n**2. JWT Token (Para APIs, móviles, scripts):**\n- Ejecuta POST /api/v1/auth/login/jwt con tus credenciales\n- Recibes un token JWT en el campo \"token\" del response\n- Haz clic en \"Authorize\" arriba a la derecha\n- Pega el token en \"bearerAuth\" (sin agregar \"Bearer \")\n- El token expira en 4 horas\n\n**¿Cuál usar?**\n- Aplicación web React → Cookie/Session (endpoint /login)\n- App móvil/API/Scripts → JWT (endpoint /login/jwt)\n",
        "contact": {
            "name": "Equipo Desarrollo",
            "email": "dev@lavioleta.com"
        },
        "license": {
            "name": "Propietario",
            "url": "https://lavioleta.com"
        },
        "version": "v1"
    },
    "servers": [
        {
            "url": "http://localhost:6820",
            "description": "Desarrollo Local"
        }
    ],
    "security": [
        {
            "cookieAuth": []
        },
        {
            "bearerAuth": []
        }
    ],
    "tags": [
        {
            "name": "Catálogo de Usuarios",
            "description": "Endpoints migrados desde FormCatalogoUsuarios"
        },
        {
            "name": "Autenticación",
            "description": "Endpoints para login y recursos iniciales"
        },
        {
            "name": "Sucursales",
            "description": "Consultas auxiliares para sucursales"
        },
        {
            "name": "Gestión de Claves",
            "description": "Endpoints para asignar y cambiar claves de usuario (migrado desde FormSistemaCambiarClave)"
        },
        {
            "name": "Bitácora de Usuarios",
            "description": "Consulta migrada de ServidorAdminSistema::ConsultaBitacoraUnificada"
        }
    ],
    "paths": {
        "/api/v1/usuarios/{id}/clave": {
            "put": {
                "tags": [
                    "Gestión de Claves"
                ],
                "summary": "Cambiar clave existente",
                "description": "Cambia la clave de un usuario que ya tiene password. Equivalente a ServidorAdminSistema::CambiaClave del sistema legado. Ambas claves (actual y nueva) deben enviarse ya cifradas en SHA-256 (64 caracteres hexadecimales).",
                "operationId": "cambiarClave",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "description": "Identificador del usuario (empleado)",
                        "required": true,
                        "schema": {
                            "type": "string"
                        },
                        "example": "CRCP"
                    }
                ],
                "requestBody": {
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/CambiarClaveRequest"
                            }
                        }
                    },
                    "required": true
                },
                "responses": {
                    "200": {
                        "description": "Clave cambiada correctamente",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ClaveResponse"
                                },
                                "example": {
                                    "success": true,
                                    "usuario": "CRCP",
                                    "message": "Clave cambiada correctamente"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Petición inválida (validación de formato hash)",
                        "content": {
                            "application/json": {}
                        }
                    },
                    "401": {
                        "description": "Clave actual incorrecta",
                        "content": {
                            "application/json": {
                                "example": {
                                    "success": false,
                                    "usuario": null,
                                    "message": "La clave actual no es correcta"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Usuario no encontrado",
                        "content": {
                            "application/json": {
                                "example": {
                                    "success": false,
                                    "usuario": null,
                                    "message": "Usuario no encontrado"
                                }
                            }
                        }
                    },
                    "409": {
                        "description": "Conflicto: la nueva clave es igual a la actual",
                        "content": {
                            "application/json": {
                                "example": {
                                    "success": false,
                                    "usuario": null,
                                    "message": "La nueva clave no puede ser igual a la clave actual"
                                }
                            }
                        }
                    }
                }
            },
            "post": {
                "tags": [
                    "Gestión de Claves"
                ],
                "summary": "Asignar clave inicial",
                "description": "Asigna una clave inicial a un usuario que no tiene password (password IS NULL). Equivalente a ServidorAdminSistema::AsignaPassword del sistema legado. La clave debe enviarse ya cifrada en SHA-256 (64 caracteres hexadecimales).",
                "operationId": "asignarClave",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "description": "Identificador del usuario (empleado)",
                        "required": true,
                        "schema": {
                            "type": "string"
                        },
                        "example": "CRCP"
                    }
                ],
                "requestBody": {
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/AsignarClaveRequest"
                            }
                        }
                    },
                    "required": true
                },
                "responses": {
                    "201": {
                        "description": "Clave asignada correctamente",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ClaveResponse"
                                },
                                "example": {
                                    "success": true,
                                    "usuario": "CRCP",
                                    "message": "Clave asignada correctamente"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Petición inválida (validación de formato hash)",
                        "content": {
                            "application/json": {}
                        }
                    },
                    "404": {
                        "description": "Usuario no encontrado",
                        "content": {
                            "application/json": {
                                "example": {
                                    "success": false,
                                    "usuario": null,
                                    "message": "Usuario no encontrado"
                                }
                            }
                        }
                    },
                    "409": {
                        "description": "Conflicto: el usuario ya tiene clave asignada",
                        "content": {
                            "application/json": {
                                "example": {
                                    "success": false,
                                    "usuario": null,
                                    "message": "El usuario ya tiene una clave asignada. Use el endpoint de cambio de clave."
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/v1/usuarios/{empleado}": {
            "get": {
                "tags": [
                    "Catálogo de Usuarios"
                ],
                "summary": "Obtener usuario",
                "description": "Consulta detallada de un usuario",
                "operationId": "obtener",
                "parameters": [
                    {
                        "name": "empleado",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Usuario encontrado",
                        "content": {
                            "*/*": {
                                "schema": {
                                    "$ref": "#/components/schemas/UsuarioResponse"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Usuario no encontrado",
                        "content": {
                            "*/*": {
                                "schema": {
                                    "$ref": "#/components/schemas/UsuarioResponse"
                                }
                            }
                        }
                    }
                }
            },
            "put": {
                "tags": [
                    "Catálogo de Usuarios"
                ],
                "summary": "Actualizar usuario",
                "description": "Modificación equivalente a GrabaUsuarios (M)",
                "operationId": "actualizar",
                "parameters": [
                    {
                        "name": "empleado",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "requestBody": {
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/UsuarioRequest"
                            }
                        }
                    },
                    "required": true
                },
                "responses": {
                    "200": {
                        "description": "Usuario actualizado",
                        "content": {
                            "*/*": {
                                "schema": {
                                    "$ref": "#/components/schemas/UsuarioResponse"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Petición inválida",
                        "content": {
                            "*/*": {
                                "schema": {
                                    "$ref": "#/components/schemas/UsuarioResponse"
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "Error interno",
                        "content": {
                            "*/*": {
                                "schema": {
                                    "$ref": "#/components/schemas/UsuarioResponse"
                                }
                            }
                        }
                    }
                }
            },
            "delete": {
                "tags": [
                    "Catálogo de Usuarios"
                ],
                "summary": "Eliminar usuario",
                "description": "Equivalente a BajaUsuario",
                "operationId": "eliminar",
                "parameters": [
                    {
                        "name": "empleado",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Usuario eliminado",
                        "content": {
                            "*/*": {
                                "schema": {
                                    "$ref": "#/components/schemas/UsuarioResponse"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Usuario no encontrado",
                        "content": {
                            "*/*": {
                                "schema": {
                                    "$ref": "#/components/schemas/UsuarioResponse"
                                }
                            }
                        }
                    },
                    "409": {
                        "description": "Restricción de referencia",
                        "content": {
                            "*/*": {
                                "schema": {
                                    "$ref": "#/components/schemas/UsuarioResponse"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/v1/usuarios": {
            "get": {
                "tags": [
                    "Catálogo de Usuarios"
                ],
                "summary": "Listar usuarios",
                "description": "Equivalente a ConsultaUsuario (grid principal)",
                "operationId": "listar",
                "parameters": [
                    {
                        "name": "soloActivos",
                        "in": "query",
                        "required": false,
                        "schema": {
                            "type": "boolean",
                            "default": true
                        }
                    },
                    {
                        "name": "filtro",
                        "in": "query",
                        "required": false,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Consulta ejecutada",
                        "content": {
                            "*/*": {
                                "schema": {
                                    "$ref": "#/components/schemas/UsuarioListResponse"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Parámetros inválidos",
                        "content": {
                            "*/*": {
                                "schema": {
                                    "$ref": "#/components/schemas/UsuarioListResponse"
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "Error interno",
                        "content": {
                            "*/*": {
                                "schema": {
                                    "$ref": "#/components/schemas/UsuarioListResponse"
                                }
                            }
                        }
                    }
                }
            },
            "post": {
                "tags": [
                    "Catálogo de Usuarios"
                ],
                "summary": "Crear usuario",
                "description": "Alta de usuario equivalente a GrabaUsuarios (A)",
                "operationId": "crear",
                "parameters": [
                    {
                        "name": "X-Sucursal",
                        "in": "header",
                        "required": false,
                        "schema": {
                            "type": "string",
                            "default": "S1"
                        }
                    }
                ],
                "requestBody": {
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/UsuarioRequest"
                            }
                        }
                    },
                    "required": true
                },
                "responses": {
                    "201": {
                        "description": "Usuario creado",
                        "content": {
                            "*/*": {
                                "schema": {
                                    "$ref": "#/components/schemas/UsuarioResponse"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Petición inválida",
                        "content": {
                            "*/*": {
                                "schema": {
                                    "$ref": "#/components/schemas/UsuarioResponse"
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "Error interno",
                        "content": {
                            "*/*": {
                                "schema": {
                                    "$ref": "#/components/schemas/UsuarioResponse"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/v1/security/privilegios/cache/flush": {
            "post": {
                "tags": [
                    "authorization-controller"
                ],
                "operationId": "flushCache",
                "responses": {
                    "200": {
                        "description": "OK"
                    }
                }
            }
        },
        "/api/v1/bitacora-unificada": {
            "post": {
                "tags": [
                    "Bitácora de Usuarios"
                ],
                "summary": "Consultar bitácora unificada",
                "description": "Ejecuta la consulta legacy ConsultaBitacoraUnificada para un rango de fechas, un usuario y opcionalmente una sucursal",
                "operationId": "consultar",
                "requestBody": {
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/BitacoraUnificadaRequest"
                            }
                        }
                    },
                    "required": true
                },
                "responses": {
                    "200": {
                        "description": "Consulta ejecutada",
                        "content": {
                            "*/*": {
                                "schema": {
                                    "$ref": "#/components/schemas/BitacoraUnificadaResponse"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Parámetros inválidos",
                        "content": {
                            "*/*": {
                                "schema": {
                                    "$ref": "#/components/schemas/BitacoraUnificadaResponse"
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "Error interno",
                        "content": {
                            "*/*": {
                                "schema": {
                                    "$ref": "#/components/schemas/BitacoraUnificadaResponse"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/v1/auth/login": {
            "post": {
                "tags": [
                    "Autenticación"
                ],
                "summary": "Autenticar usuario",
                "description": "Valida credenciales y devuelve información de sesión / perfil.",
                "operationId": "login",
                "requestBody": {
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/LoginRequest"
                            }
                        }
                    },
                    "required": true
                },
                "responses": {
                    "200": {
                        "description": "Autenticación exitosa",
                        "content": {
                            "*/*": {
                                "schema": {
                                    "$ref": "#/components/schemas/LoginResponse"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Credenciales inválidas",
                        "content": {
                            "*/*": {
                                "schema": {
                                    "$ref": "#/components/schemas/LoginResponse"
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "Error interno",
                        "content": {
                            "*/*": {
                                "schema": {
                                    "$ref": "#/components/schemas/LoginResponse"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/v1/auth/login/jwt": {
            "post": {
                "tags": [
                    "Autenticación"
                ],
                "summary": "Autenticar usuario con JWT",
                "description": "Valida credenciales y retorna un JSON Web Token (JWT) para autenticación posterior. No crea sesión cookie - el token debe enviarse en cada petición vía header 'Authorization: Bearer {token}'.",
                "operationId": "loginJwt",
                "requestBody": {
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/LoginRequest"
                            }
                        }
                    },
                    "required": true
                },
                "responses": {
                    "200": {
                        "description": "Autenticación exitosa - Token JWT generado",
                        "content": {
                            "*/*": {
                                "schema": {
                                    "$ref": "#/components/schemas/LoginResponse"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Credenciales inválidas",
                        "content": {
                            "*/*": {
                                "schema": {
                                    "$ref": "#/components/schemas/LoginResponse"
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "Error interno",
                        "content": {
                            "*/*": {
                                "schema": {
                                    "$ref": "#/components/schemas/LoginResponse"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/v1/usuarios/empleados-disponibles": {
            "get": {
                "tags": [
                    "Catálogo de Usuarios"
                ],
                "summary": "Listar empleados disponibles",
                "description": "Tercer result set legacy para llenar combos",
                "operationId": "empleadosDisponibles",
                "responses": {
                    "200": {
                        "description": "Consulta ejecutada",
                        "content": {
                            "*/*": {
                                "schema": {
                                    "type": "array",
                                    "items": {
                                        "$ref": "#/components/schemas/EmpleadoOptionResponse"
                                    }
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "Error interno",
                        "content": {
                            "*/*": {
                                "schema": {
                                    "type": "array",
                                    "items": {
                                        "$ref": "#/components/schemas/EmpleadoOptionResponse"
                                    }
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/v1/usuarios/combo-box": {
            "get": {
                "tags": [
                    "Catálogo de Usuarios"
                ],
                "summary": "ComboBox de usuarios",
                "description": "Lista usuarios para llenar combos generales, con filtro opcional por sucursal.",
                "operationId": "comboUsuarios",
                "parameters": [
                    {
                        "name": "sucursal",
                        "in": "query",
                        "required": false,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Consulta ejecutada",
                        "content": {
                            "*/*": {
                                "schema": {
                                    "type": "array",
                                    "items": {
                                        "$ref": "#/components/schemas/UsuarioComboOptionResponse"
                                    }
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "Error interno",
                        "content": {
                            "*/*": {
                                "schema": {
                                    "type": "array",
                                    "items": {
                                        "$ref": "#/components/schemas/UsuarioComboOptionResponse"
                                    }
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/v1/sucursales/combo-box": {
            "get": {
                "tags": [
                    "Sucursales"
                ],
                "summary": "ComboBox de sucursales",
                "description": "Lista sucursales para combos, con filtro opcional por empresa.",
                "operationId": "comboSucursales",
                "parameters": [
                    {
                        "name": "idEmpresa",
                        "in": "query",
                        "required": false,
                        "schema": {
                            "type": "integer",
                            "format": "int32"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Consulta ejecutada",
                        "content": {
                            "*/*": {
                                "schema": {
                                    "type": "array",
                                    "items": {
                                        "$ref": "#/components/schemas/SucursalComboOptionResponse"
                                    }
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "Error interno",
                        "content": {
                            "*/*": {
                                "schema": {
                                    "type": "array",
                                    "items": {
                                        "$ref": "#/components/schemas/SucursalComboOptionResponse"
                                    }
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/v1/security/privilegios": {
            "get": {
                "tags": [
                    "authorization-controller"
                ],
                "operationId": "listar_1",
                "responses": {
                    "200": {
                        "description": "OK",
                        "content": {
                            "*/*": {
                                "schema": {
                                    "type": "array",
                                    "items": {
                                        "$ref": "#/components/schemas/ObjetoPrivilegiosDTO"
                                    }
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/v1/security/privilegios/{objeto}": {
            "get": {
                "tags": [
                    "authorization-controller"
                ],
                "operationId": "listarPorObjeto",
                "parameters": [
                    {
                        "name": "objeto",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "content": {
                            "*/*": {
                                "schema": {
                                    "type": "array",
                                    "items": {
                                        "$ref": "#/components/schemas/PrivilegioDTO"
                                    }
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/v1/security/privilegios/{objeto}/{privilegio}": {
            "get": {
                "tags": [
                    "authorization-controller"
                ],
                "operationId": "revisar",
                "parameters": [
                    {
                        "name": "objeto",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    },
                    {
                        "name": "privilegio",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "content": {
                            "*/*": {
                                "schema": {
                                    "$ref": "#/components/schemas/PrivilegeCheckResponse"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/v1/security/privilegios/version/requerimientos": {
            "get": {
                "tags": [
                    "authorization-controller"
                ],
                "operationId": "version",
                "responses": {
                    "200": {
                        "description": "OK",
                        "content": {
                            "*/*": {
                                "schema": {
                                    "$ref": "#/components/schemas/VersionRequirementDTO"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/v1/security/privilegios/self": {
            "get": {
                "tags": [
                    "authorization-controller"
                ],
                "operationId": "listarSelf",
                "responses": {
                    "200": {
                        "description": "OK",
                        "content": {
                            "*/*": {
                                "schema": {
                                    "type": "array",
                                    "items": {
                                        "$ref": "#/components/schemas/ObjetoPrivilegiosDTO"
                                    }
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/v1/auth/sucursales": {
            "get": {
                "tags": [
                    "Autenticación"
                ],
                "summary": "Listar sucursales",
                "description": "Obtiene catálogo de sucursales disponibles para autenticación.",
                "operationId": "obtenerSucursales",
                "responses": {
                    "200": {
                        "description": "Listado obtenido",
                        "content": {
                            "*/*": {
                                "schema": {
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "Error interno",
                        "content": {
                            "*/*": {
                                "schema": {
                                    "type": "object"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/v1/auth/status": {
            "get": {
                "tags": [
                    "Autenticación"
                ],
                "summary": "Estado del servicio de autenticación",
                "description": "Devuelve mensaje simple para monitoreo / health check.",
                "operationId": "status",
                "responses": {
                    "200": {
                        "description": "OK",
                        "content": {
                            "*/*": {
                                "schema": {
                                    "type": "string"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/v1/security/privilegios/cache/{usuario}": {
            "delete": {
                "tags": [
                    "authorization-controller"
                ],
                "operationId": "flushCacheUsuario",
                "parameters": [
                    {
                        "name": "usuario",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK"
                    }
                }
            }
        },
        "/api/v1/security/privilegios/cache/self": {
            "delete": {
                "tags": [
                    "authorization-controller"
                ],
                "operationId": "flushCachePropio",
                "responses": {
                    "200": {
                        "description": "OK"
                    }
                }
            }
        }
    },
    "components": {
        "schemas": {
            "CambiarClaveRequest": {
                "type": "object",
                "description": "Petición para cambiar la clave de un usuario existente",
                "properties": {
                    "claveActual": {
                        "type": "string",
                        "description": "Hash SHA-256 de la clave actual (64 caracteres hex)",
                        "example": "9f86d081884c7d659a2feaa0c55ad015a3bf4f1b2b0b822cd15d6c15b0f00a08",
                        "maxLength": 64,
                        "minLength": 64,
                        "pattern": "^[a-fA-F0-9]{64}$"
                    },
                    "nuevaClave": {
                        "type": "string",
                        "description": "Hash SHA-256 de la nueva clave (64 caracteres hex)",
                        "example": "3c5636d872b042199e6a04a0e1e77aa15641244b7c5a826c71da5dce9d765a61",
                        "maxLength": 64,
                        "minLength": 64,
                        "pattern": "^[a-fA-F0-9]{64}$"
                    }
                },
                "required": [
                    "claveActual",
                    "nuevaClave"
                ]
            },
            "ClaveResponse": {
                "type": "object",
                "description": "Respuesta de operación de clave de usuario",
                "properties": {
                    "success": {
                        "type": "boolean",
                        "description": "Indica si la operación fue exitosa"
                    },
                    "usuario": {
                        "type": "string",
                        "description": "Identificador del usuario afectado",
                        "example": "CRCP"
                    },
                    "message": {
                        "type": "string",
                        "description": "Mensaje descriptivo del resultado"
                    }
                }
            },
            "UsuarioRequest": {
                "type": "object",
                "description": "Datos requeridos para crear o actualizar un usuario legado",
                "properties": {
                    "empleado": {
                        "type": "string",
                        "description": "Clave del empleado al que se asociará el usuario",
                        "example": "CRCP",
                        "minLength": 1
                    },
                    "password": {
                        "type": "string",
                        "description": "Contraseña del sistema legado (se almacena tal cual en la tabla usuarios)"
                    },
                    "activo": {
                        "type": "boolean",
                        "description": "Indica si el usuario está activo",
                        "example": true
                    },
                    "fechaAlta": {
                        "type": "string",
                        "format": "date",
                        "description": "Fecha de alta en formato ISO (se usa la fecha actual si no se envía)",
                        "example": "2024-01-15"
                    },
                    "fechaBaja": {
                        "type": "string",
                        "format": "date",
                        "description": "Fecha de baja en formato ISO (por defecto 2099-01-01)",
                        "example": "2099-01-01"
                    },
                    "usuarioContpaq": {
                        "type": "string",
                        "description": "Usuario asociado al sistema Contpaq",
                        "example": "CRCP_CONT"
                    },
                    "passwordContpaq": {
                        "type": "string",
                        "description": "Contraseña para el sistema Contpaq"
                    }
                },
                "required": [
                    "empleado"
                ]
            },
            "UsuarioDetail": {
                "type": "object",
                "properties": {
                    "empleado": {
                        "type": "string"
                    },
                    "nombreCompleto": {
                        "type": "string"
                    },
                    "activo": {
                        "type": "boolean"
                    },
                    "fechaAlta": {
                        "type": "string",
                        "format": "date"
                    },
                    "fechaBaja": {
                        "type": "string",
                        "format": "date"
                    },
                    "ultimoAcceso": {
                        "type": "string",
                        "format": "date"
                    },
                    "password": {
                        "type": "string"
                    },
                    "usuarioContpaq": {
                        "type": "string"
                    },
                    "passwordContpaq": {
                        "type": "string"
                    }
                }
            },
            "UsuarioResponse": {
                "type": "object",
                "description": "Respuesta estándar para operaciones de catálogo de usuarios",
                "properties": {
                    "success": {
                        "type": "boolean"
                    },
                    "message": {
                        "type": "string"
                    },
                    "usuario": {
                        "$ref": "#/components/schemas/UsuarioDetail"
                    }
                }
            },
            "AsignarClaveRequest": {
                "type": "object",
                "description": "Petición para asignar clave inicial a un usuario sin contraseña",
                "properties": {
                    "nuevaClave": {
                        "type": "string",
                        "description": "Hash SHA-256 de la nueva clave (64 caracteres hex)",
                        "example": "9f86d081884c7d659a2feaa0c55ad015a3bf4f1b2b0b822cd15d6c15b0f00a08",
                        "maxLength": 64,
                        "minLength": 64,
                        "pattern": "^[a-fA-F0-9]{64}$"
                    }
                },
                "required": [
                    "nuevaClave"
                ]
            },
            "BitacoraUnificadaRequest": {
                "type": "object",
                "description": "Filtros para consultar la bitácora unificada de usuarios",
                "properties": {
                    "fechaInicio": {
                        "type": "string",
                        "format": "date",
                        "description": "Fecha inicial del rango (incluyente)",
                        "example": "2025-01-01"
                    },
                    "fechaFin": {
                        "type": "string",
                        "format": "date",
                        "description": "Fecha final del rango (incluyente)",
                        "example": "2025-01-31"
                    },
                    "usuario": {
                        "type": "string",
                        "description": "Clave de empleado a consultar",
                        "example": "USR001",
                        "minLength": 1
                    },
                    "sucursal": {
                        "type": "string",
                        "description": "Sucursal a la que pertenece la actividad del usuario",
                        "example": "S1"
                    },
                    "rangoFechasValido": {
                        "type": "boolean"
                    }
                },
                "required": [
                    "fechaFin",
                    "fechaInicio",
                    "usuario"
                ]
            },
            "BitacoraUnificadaResponse": {
                "type": "object",
                "description": "Resultado de la consulta de bitácora unificada de usuarios",
                "properties": {
                    "success": {
                        "type": "boolean"
                    },
                    "message": {
                        "type": "string"
                    },
                    "eventos": {
                        "type": "array",
                        "items": {
                            "$ref": "#/components/schemas/BitacoraUsuarioEntry"
                        }
                    }
                }
            },
            "BitacoraUsuarioEntry": {
                "type": "object",
                "description": "Evento registrado en la bitácora unificada",
                "properties": {
                    "referencia": {
                        "type": "string"
                    },
                    "tipoDocumento": {
                        "type": "string"
                    },
                    "operacion": {
                        "type": "string"
                    },
                    "cancelado": {
                        "type": "boolean"
                    },
                    "fechaDocumento": {
                        "type": "string",
                        "format": "date"
                    },
                    "usuario": {
                        "type": "string"
                    },
                    "fechaOperacion": {
                        "type": "string",
                        "format": "date"
                    },
                    "horaOperacion": {
                        "type": "string"
                    }
                }
            },
            "LoginRequest": {
                "type": "object",
                "properties": {
                    "usuario": {
                        "type": "string",
                        "maxLength": 50,
                        "minLength": 3,
                        "pattern": "^[A-Za-z0-9_]+$"
                    },
                    "passwordHash": {
                        "type": "string",
                        "maxLength": 64,
                        "minLength": 64,
                        "pattern": "^[a-fA-F0-9]{64}$"
                    },
                    "sucursal": {
                        "type": "string"
                    }
                },
                "required": [
                    "passwordHash",
                    "usuario"
                ]
            },
            "LoginResponse": {
                "type": "object",
                "properties": {
                    "success": {
                        "type": "boolean"
                    },
                    "message": {
                        "type": "string"
                    },
                    "usuario": {
                        "$ref": "#/components/schemas/UsuarioInfo"
                    },
                    "token": {
                        "type": "string"
                    }
                }
            },
            "UsuarioInfo": {
                "type": "object",
                "properties": {
                    "empleado": {
                        "type": "string"
                    },
                    "nombre": {
                        "type": "string"
                    },
                    "sucursal": {
                        "type": "string"
                    },
                    "sucursalNombre": {
                        "type": "string"
                    },
                    "idempresa": {
                        "type": "integer",
                        "format": "int32"
                    },
                    "activo": {
                        "type": "boolean"
                    },
                    "perfil": {
                        "type": "string"
                    }
                }
            },
            "UsuarioListResponse": {
                "type": "object",
                "description": "Listado de usuarios con metadatos",
                "properties": {
                    "success": {
                        "type": "boolean"
                    },
                    "message": {
                        "type": "string"
                    },
                    "usuarios": {
                        "type": "array",
                        "items": {
                            "$ref": "#/components/schemas/UsuarioSummary"
                        }
                    }
                }
            },
            "UsuarioSummary": {
                "type": "object",
                "properties": {
                    "empleado": {
                        "type": "string"
                    },
                    "nombre": {
                        "type": "string"
                    },
                    "ultimoAcceso": {
                        "type": "string",
                        "format": "date"
                    },
                    "activo": {
                        "type": "boolean"
                    }
                }
            },
            "EmpleadoOptionResponse": {
                "type": "object",
                "description": "Elemento para combos de selección de empleados",
                "properties": {
                    "empleado": {
                        "type": "string"
                    },
                    "nombreCompleto": {
                        "type": "string"
                    },
                    "tieneUsuario": {
                        "type": "boolean"
                    }
                }
            },
            "UsuarioComboOptionResponse": {
                "type": "object",
                "description": "Elemento para ComboBox general de usuarios",
                "properties": {
                    "empleado": {
                        "type": "string"
                    },
                    "nombreCompleto": {
                        "type": "string"
                    },
                    "sucursal": {
                        "type": "string"
                    }
                }
            },
            "SucursalComboOptionResponse": {
                "type": "object",
                "description": "Elemento para ComboBox general de sucursales",
                "properties": {
                    "sucursal": {
                        "type": "string"
                    },
                    "nombre": {
                        "type": "string"
                    }
                }
            },
            "ObjetoPrivilegiosDTO": {
                "type": "object",
                "properties": {
                    "objeto": {
                        "type": "string"
                    },
                    "privilegios": {
                        "type": "array",
                        "items": {
                            "type": "string"
                        }
                    }
                }
            },
            "PrivilegioDTO": {
                "type": "object",
                "properties": {
                    "objeto": {
                        "type": "string"
                    },
                    "privilegio": {
                        "type": "string"
                    },
                    "descripcion": {
                        "type": "string"
                    }
                }
            },
            "PrivilegeCheckResponse": {
                "type": "object",
                "properties": {
                    "objeto": {
                        "type": "string"
                    },
                    "privilegio": {
                        "type": "string"
                    },
                    "allowed": {
                        "type": "boolean"
                    }
                }
            },
            "VersionRequirementDTO": {
                "type": "object",
                "properties": {
                    "versionMinima": {
                        "type": "string"
                    },
                    "subversionMinima": {
                        "type": "string"
                    },
                    "tiempoValidezMinutos": {
                        "type": "integer",
                        "format": "int32"
                    }
                }
            }
        },
        "securitySchemes": {
            "cookieAuth": {
                "type": "apiKey",
                "description": "**Autenticación basada en sesión HTTP (para aplicaciones web)**\n\n1. Ejecuta POST /api/v1/auth/login con tus credenciales\n2. La sesión se crea automáticamente (cookie JSESSIONID)\n3. Las cookies se envían automáticamente en los siguientes requests\n\nIdeal para: Aplicación web React, navegadores\n",
                "name": "JSESSIONID",
                "in": "cookie"
            },
            "bearerAuth": {
                "type": "http",
                "description": "**Autenticación basada en JWT (para APIs, móviles, scripts)**\n\n1. Ejecuta POST /api/v1/auth/login/jwt con tus credenciales\n2. Copia el token del campo \"token\" en el response\n3. Haz clic en \"Authorize\" arriba a la derecha\n4. Pega el token en este campo (sin agregar \"Bearer \")\n5. Usa el token en tus requests: Authorization: Bearer {token}\n\nEl token expira en 4 horas.\n\nIdeal para: Apps móviles, APIs externas, scripts de automatización\n",
                "scheme": "bearer",
                "bearerFormat": "JWT"
            }
        }
    }
}